# 学習アプリ開発プラットフォーム

## 📚 概要

学年単位で学習コンテンツを作成できる開発プラットフォームです。教師が**セクション（学年）→ フェーズ（大単元）→ モジュール（中単元）→ ステップ（学習内容）**という階層構造で教材を作成し、生徒が学習できます。

## 🎯 主な特徴

### 階層構造
- **セクション**: 学年単位の最上位概念（例：中学1年生の数学）
- **フェーズ**: 1学年内の大単元（例：正の数・負の数、文字式）
- **モジュール**: フェーズ内の中単元（例：加法、減法）
- **ステップ**: 最小単位の学習コンテンツ（1ステップ1概念）

### 教師画面と生徒画面の分離
- **教師画面** (`/` または `/teacher/*`): コンテンツ作成・管理
- **生徒画面** (`/student/*`): 学習コンテンツの閲覧・学習
- 生徒画面から教師画面へのアクセスは不可、教師からの一方向のみ

### 生徒画面の機能
- **セクション選択**: プルダウンで学年を切り替え可能
- **進捗管理**: 学習の進み具合を自動記録
- **達成記録**: ポイント獲得と達成履歴の確認

### 教師画面の機能
- **ノーコード開発**: プログラミング不要で教材作成
- **柔軟な構造**: 階層を自由に組み合わせて構成
- **プレビュー機能**: 生徒画面を確認しながら作成

## 🌐 アクセス URL

**開発環境**: https://3000-i6ktus6p7ehk606d96lyk-583b4d74.sandbox.novita.ai

### 主要ページ

#### 教師用画面
- トップページ: `/`
- セクション管理: `/teacher/sections`
- フェーズ管理: `/teacher/phases`
- モジュール管理: `/teacher/modules`
- ステップ管理: `/teacher/steps`
- 生徒画面プレビュー: `/student`

#### 生徒用画面
- トップページ: `/student`
- デモ（数学学習アプリ）: `/student/demo`
- 達成記録: `/student/achievements`

## 🏗️ 技術スタック

- **フロントエンド**: HTML, Tailwind CSS, Vanilla JavaScript, Axios
- **バックエンド**: Hono (TypeScript Web Framework)
- **デプロイ**: Cloudflare Pages/Workers
- **データベース**: Cloudflare D1 (SQLite)
- **開発ツール**: Vite, PM2, TypeScript

## 📊 データ構造

### 主要テーブル

#### プラットフォーム基盤
1. **sections**: セクション（学年単位のプロジェクト）
2. **phases**: フェーズ（大単元）
3. **modules**: モジュール（中単元）
4. **steps**: ステップ（学習ステップ）
5. **content_blocks**: コンテンツブロック（ステップ内の要素）
6. **questions**: 問題（ステップに関連する問題）
7. **question_options**: 選択肢（選択式問題の選択肢）
8. **interactive_elements**: インタラクティブ要素（図形、グラフなど）

#### 生徒用データ
1. **user_progress**: ユーザーの学習進捗
2. **answer_history**: 解答履歴と正解率
3. **achievement_log**: 達成記録とポイント

## 🎨 コンテンツ作成フロー

### 1. セクション作成
1. `/teacher/sections` にアクセス
2. 「新しいセクションを作成」フォームに入力
   - セクション名（例：中学1年生の数学）
   - 学年レベル（例：中1）
   - 教科（例：数学）
   - 説明
3. 「セクションを作成」ボタンをクリック

### 2. フェーズ作成
1. `/teacher/phases` にアクセス
2. セクションを選択
3. 「新しいフェーズを作成」フォームに入力
   - フェーズ名（例：正の数・負の数）
   - 説明
   - 表示順序
4. 「フェーズを作成」ボタンをクリック

### 3. モジュール作成
1. `/teacher/modules` にアクセス
2. セクションとフェーズを選択
3. 「新しいモジュールを作成」フォームに入力
   - モジュール名（例：加法と減法）
   - アイコン（絵文字）
   - カラー
   - 説明
   - 表示順序
4. 「モジュールを作成」ボタンをクリック

### 4. ステップ作成
1. `/teacher/steps` にアクセス
2. セクション、フェーズ、モジュールを選択
3. 「新しいステップを作成」フォームに入力
   - ステップタイトル（例：正の数とは？）
   - 説明文
   - 表示順序
4. 「ステップを作成」ボタンをクリック

## 📦 ローカル開発

### セットアップ

```bash
# 依存関係インストール
npm install

# データベースマイグレーション（ローカル）
npm run db:migrate:local

# テストデータ投入
npx wrangler d1 execute webapp-production --local --file=./test_data.sql
npx wrangler d1 execute webapp-production --local --file=./test_sections.sql

# ビルド
npm run build

# 開発サーバー起動（PM2）
pm2 start ecosystem.config.cjs

# サーバー確認
curl http://localhost:3000
```

### 開発コマンド

```bash
npm run dev          # Vite開発サーバー
npm run build        # プロダクションビルド
npm run preview      # ビルド結果のプレビュー
npm run deploy       # Cloudflare Pagesへデプロイ

# データベース操作
npm run db:migrate:local   # ローカルDBマイグレーション
npm run db:migrate:prod    # 本番DBマイグレーション
npm run db:reset           # DBリセット＆再構築
npm run db:console:local   # ローカルDBコンソール
npm run db:console:prod    # 本番DBコンソール
```

## 🚀 デプロイメント

### Cloudflare Pages

```bash
# ビルド
npm run build

# デプロイ
npm run deploy
```

## 📝 現在の実装状況

### ✅ 完了
- セクション（学年）管理のデータベース構造
- 教師画面と生徒画面の完全分離
- セクション選択機能（生徒画面）
- フェーズ・モジュール・ステップの作成API
- 基本的な管理画面UI

### 🚧 今後の実装予定
- セクション管理画面UI
- コンテンツブロック編集機能
- 問題作成UI（選択式、記述式）
- インタラクティブ要素（グラフ、図形、表）
- 生徒画面でのセクション別コンテンツ表示

## 🎯 対象ユーザー

- **教師**: 学年単位で教材を作成したい教育者
- **生徒**: 自分の学年に合わせて学習したい学習者
- **教育機関**: カスタマイズ可能な学習プラットフォームを求める学校

## 📄 ライセンス

このプロジェクトは教育目的で開発されています。

---

**最終更新**: 2026-01-26
**バージョン**: 2.1.0
**ステータス**: ✅ アルファ版（階層構造実装完了）
