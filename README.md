# 学習アプリ (Learning App)

Cloudflare Pages + Hono で構築された軽量な学習管理システムです。
教師が学習コンテンツ（セクション、フェーズ、モジュール、ステップ）を作成し、生徒がそれを閲覧・学習することができます。

## 主な機能

### 👥 ポータル (/)
誰でもアクセスできる入り口ページです。
- 生徒用ログインへのリンク
- 教師用ログインへのリンク

### 👨‍🏫 教師用機能
- **ログイン (/login)**: 教師専用のログイン画面。
- **ダッシュボード (/teacher)**: コンテンツ管理のハブ。
- **セクション管理**: 学年やクラス単位での学習プロジェクト管理。
- **コンテンツ作成**: フェーズ（大単元）、モジュール（中単元）、ステップ（小単元）の階層構造で教材を作成。
- **生徒管理**: 
    - 生徒コード（ログインID）の発行（自動生成）。
    - 既存の生徒コードの追加（他の教師が発行した生徒の共有）。
    - 生徒コードの削除。
    - メモ機能（個人名との紐付け用）。
- **用語集管理**: 学習用語の登録・編集・削除。
- **生徒画面プレビュー**: 生徒用画面の見た目やコンテンツを教師権限で確認。
- **生徒からの質問対応**: モジュールごとの質問一覧の確認・返信、未返信件数の把握。

### 👨‍🎓 生徒用機能
- **ログイン (/student/login)**: 教師から配布された「生徒コード」を使ってログイン。
- **学習画面 (/student)**: 割り当てられたセクションの学習コンテンツを閲覧。
- **質問送信**: モジュール学習中に担当教師へ直接質問を送信。
- **用語集**: 登録された学習用語の検索と閲覧。

## 開発環境のセットアップ

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動 (ローカルDB使用)
npm run dev

# ビルド
npm run build
```

## デプロイ

Cloudflare Pagesへのデプロイに対応しています。

```bash
# プロダクションへのデプロイ
npm run deploy:prod
```

## データ構造

Cloudflare D1 (SQLite) を使用しています。

- `users`: ユーザー管理（教師・生徒）
- `sections`: 学習コース（セクション）
- `phases`: 大単元
- `modules`: 中単元
- `steps`: 学習ステップ
- `assignments`: 生徒へのセクション割り当て
- `progress`: 学習進捗
- `glossary_terms`: 用語集
- `teacher_students`: 教師と生徒の紐付け（メモ含む）
- `student_questions`: 生徒から教師への質問（本文・返信・状態）

## 質問機能の使い方

### 生徒側
1. モジュール学習画面右上の「先生に質問する」ボタンをクリック。
2. 表示されたダイアログに質問内容を入力し、送信。
3. ステップ情報付きで担当教師に送信され、返信があるまで待機。

### 教師側
1. 教師ダッシュボードから質問一覧を確認。
2. 各質問に対して返信を入力すると、生徒側に回答が反映。
3. 未返信件数エンドポイントで対応状況を把握可能。

## アカウント仕様
- **教師**: `username` と `password` でログイン。
- **生徒**: 教師が発行した「生徒コード」(`username`) とパスワードでログイン。
